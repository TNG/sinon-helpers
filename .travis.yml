language: node_js
node_js:
- node
- 10
- 8
- 6

branches:
  except:
  - /^v\d+\.\d+\.\d+$/

script:
- istanbul cover ./node_modules/.bin/_mocha --report lcovonly -- -R spec
- codecov

jobs:
  include:
  - stage: release
    node_js: node
    deploy:
      provider: script
      skip_cleanup: true
      script:
      - npx semantic-release
